CREATE USER SA PASSWORD "" ADMIN
/*C1*/SET SCHEMA PUBLIC
CONNECT USER SA
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
/*C2*/SET SCHEMA PUBLIC
CONNECT USER SA
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
drop table services_channel_lastscan_timestamp if exists
create table services_channel_lastscan_timestamp (id bigint generated by default as identity (start with 1), clientId varchar(255) not null, channel varchar(255) not null, timestamp timestamp not null, primary key (id))
SET AUTOCOMMIT FALSE
/*C3*/SET SCHEMA PUBLIC
CONNECT USER SA
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
drop table openmobster_device if exists
drop table openmobster_device_attribute if exists
drop table openmobster_device_attributes if exists
drop table openmobster_group if exists
drop table openmobster_group_attribute if exists
drop table openmobster_group_attributes if exists
drop table openmobster_identity if exists
drop table openmobster_identity_attribute if exists
drop table openmobster_identity_attributes if exists
drop table openmobster_identity_group if exists
create table openmobster_device (deviceId bigint generated by default as identity (start with 1), identifier varchar(255) not null, identityId bigint not null, primary key (deviceId), unique (identifier), unique (identityId))
create table openmobster_device_attribute (attributeId bigint generated by default as identity (start with 1), name varchar(255) not null, value varchar(255) not null, primary key (attributeId))
create table openmobster_device_attributes (deviceId bigint not null, elt bigint not null, primary key (deviceId, elt), unique (elt))
create table openmobster_group (groupId bigint generated by default as identity (start with 1), name varchar(255) not null, primary key (groupId), unique (name))
create table openmobster_group_attribute (attributeId bigint generated by default as identity (start with 1), name varchar(255) not null, value varchar(255) not null, primary key (attributeId))
create table openmobster_group_attributes (groupId bigint not null, elt bigint not null, primary key (groupId, elt), unique (elt))
create table openmobster_identity (identityId bigint generated by default as identity (start with 1), principal varchar(255) not null, credential varchar(255) not null, primary key (identityId), unique (principal))
create table openmobster_identity_attribute (attributeId bigint generated by default as identity (start with 1), name varchar(255) not null, value varchar(255) not null, primary key (attributeId))
create table openmobster_identity_attributes (identityId bigint not null, elt bigint not null, primary key (identityId, elt), unique (elt))
create table openmobster_identity_group (identityId bigint not null, groupId bigint not null, primary key (groupId, identityId))
alter table openmobster_device add constraint FK4FCAC6B12DF66534 foreign key (identityId) references openmobster_identity
alter table openmobster_device_attributes add constraint FKDEBCCFA57674144C foreign key (deviceId) references openmobster_device
alter table openmobster_device_attributes add constraint FKDEBCCFA5F2AA232E foreign key (elt) references openmobster_device_attribute
alter table openmobster_group_attributes add constraint FKA46F85B2CD4AA55C foreign key (groupId) references openmobster_group
alter table openmobster_group_attributes add constraint FKA46F85B28BD71FE7 foreign key (elt) references openmobster_group_attribute
alter table openmobster_identity_attributes add constraint FKB77E4EFDC3C9BAAE foreign key (elt) references openmobster_identity_attribute
alter table openmobster_identity_attributes add constraint FKB77E4EFD2DF66534 foreign key (identityId) references openmobster_identity
alter table openmobster_identity_group add constraint FK7C3CE119CD4AA55C foreign key (groupId) references openmobster_group
alter table openmobster_identity_group add constraint FK7C3CE1192DF66534 foreign key (identityId) references openmobster_identity
SET AUTOCOMMIT FALSE
INSERT INTO OPENMOBSTER_GROUP VALUES(1,'standard')
COMMIT
INSERT INTO OPENMOBSTER_IDENTITY VALUES(1,'blah@gmail.com','7/FtwOcrn4moXfGc57RJ6MnSKZsMSpc2giDwdOf6WSodIyltZJOf9TRc87c4LE49Pm1wmqwQevFypJUz80ezjg==')
INSERT INTO OPENMOBSTER_IDENTITY_ATTRIBUTE VALUES(1,'email','blah@gmail.com')
INSERT INTO OPENMOBSTER_IDENTITY_ATTRIBUTE VALUES(2,'inactive_credential','blahblah')
INSERT INTO OPENMOBSTER_IDENTITY_ATTRIBUTE VALUES(3,'active','true')
INSERT INTO OPENMOBSTER_IDENTITY_ATTRIBUTES VALUES(1,1)
INSERT INTO OPENMOBSTER_IDENTITY_ATTRIBUTES VALUES(1,2)
INSERT INTO OPENMOBSTER_IDENTITY_ATTRIBUTES VALUES(1,3)
INSERT INTO OPENMOBSTER_IDENTITY_GROUP VALUES(1,1)
COMMIT
INSERT INTO OPENMOBSTER_DEVICE VALUES(1,'IMEI:12345',1)
INSERT INTO OPENMOBSTER_DEVICE_ATTRIBUTE VALUES(1,'nonce','7/FtwOcrn4moXfGc57RJ6MnSKZsMSpc2giDwdOf6WSodIyltZJOf9TRc87c4LE49Pm1wmqwQevFypJUz80ezjg==')
INSERT INTO OPENMOBSTER_DEVICE_ATTRIBUTES VALUES(1,1)
COMMIT
/*C2*/INSERT INTO SERVICES_CHANNEL_LASTSCAN_TIMESTAMP VALUES(1,'IMEI:12345','twitterChannel','2010-02-11 18:25:59.445000000')
COMMIT
INSERT INTO SERVICES_CHANNEL_LASTSCAN_TIMESTAMP VALUES(2,'IMEI:12345','mock','2010-02-11 18:25:59.471000000')
COMMIT
DELETE FROM SERVICES_CHANNEL_LASTSCAN_TIMESTAMP WHERE ID=1
INSERT INTO SERVICES_CHANNEL_LASTSCAN_TIMESTAMP VALUES(1,'IMEI:12345','twitterChannel','2010-02-11 18:26:19.446000000')
COMMIT
DELETE FROM SERVICES_CHANNEL_LASTSCAN_TIMESTAMP WHERE ID=2
INSERT INTO SERVICES_CHANNEL_LASTSCAN_TIMESTAMP VALUES(2,'IMEI:12345','mock','2010-02-11 18:26:19.470000000')
COMMIT
