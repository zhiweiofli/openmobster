<project>
	<parent>
		<groupId>org.openmobster.core</groupId>
		<artifactId>core</artifactId>
		<version>2.0-M1</version>
		<relativePath>../pom.xml</relativePath>
	</parent>
	
	<modelVersion>4.0.0</modelVersion>	
	<name>examples</name>	
	<artifactId>examples</artifactId>	
	<packaging>pom</packaging>
	
	<modules>
		<module>offline-app</module>
		<module>mobile-rpc</module>
	</modules>
	 
	<profiles>
		<profile>
			<id>bin-release</id>
			<build>
			<plugins>			      		
	     		<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-antrun-plugin</artifactId>
					<executions>									    										
						<execution>
						    <id>Examples Binary release</id>
							<phase>package</phase>
							<configuration>
								<tasks>
									<delete dir="${basedir}/target"/>
									
									<!-- Package offline-app into a single jar (contains both cloud and moblet artifacts) -->
									<unzip src="${basedir}/offline-app/cloud/target/offline-app-cloud-${project.version}.jar" 
							    	dest="${basedir}/target/offline-app/cloud" overwrite="true"/>
							    	<copy todir="${basedir}/target/offline-app/moblet" overwrite="true">
										<fileset dir="${basedir}/offline-app/moblet/target/rapc">
											<include name="**/*.cod"/>
											<include name="**/*.jad"/>
										</fileset>
										<fileset dir="${basedir}/offline-app/moblet/target/classes">
											<include name="**/META-INF/**"/>
										</fileset>
									</copy>
							    	
							    	<jar file="${basedir}/target/offline-app.jar">
						        		<fileset dir="${basedir}/target/offline-app/cloud">						        		
						        		</fileset>	
						        		<fileset dir="${basedir}/target/offline-app/moblet">
							        	</fileset>					        						        								        						    
						           </jar>
									
									<!-- Package mobile-rpc into a single jar (contains both cloud and moblet artifacts) --> 
								</tasks>
							</configuration>
						</execution>
					</executions>
				</plugin>
			</plugins>
			</build>
		</profile>
	</profiles>
</project>
